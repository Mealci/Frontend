name: CI

on:
  push:
    branches:
      - '*'

jobs:
  ci:
    name: CI Flutter
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Configuration de Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.24.2'
        channel: 'stable'
    
    - name: D√©sactiver les animations CLI
      run: flutter config --no-cli-animations
    
    - name: Obtenir les d√©pendances
      run: |
        echo -e "\e[1;34müîç Obtention des d√©pendances...\e[0m"
        flutter pub get
        echo -e "\e[1;32m‚úÖ D√©pendances r√©cup√©r√©es avec succ√®s !\e[0m"
    
    - name: Formater le code
      run: |
        echo -e "\e[1;34müñåÔ∏è Formatage du code...\e[0m"
        dart format --set-exit-if-changed .
        echo -e "\e[1;32m‚úÖ Code format√© avec succ√®s !\e[0m"
    
    - name: Ex√©cuter les tests
      run: |
        echo -e "\e[1;34müß™ Ex√©cution des tests...\e[0m"
        echo "espace r√©serv√© pour flutter test"
        echo -e "\e[1;32m‚úÖ Tests termin√©s avec succ√®s !\e[0m"
    
    - name: V√©rifier la porte de qualit√©
      if: success()
      run: |
        echo -e "\e[1;32m‚úÖ Porte de qualit√© pass√©e\e[0m"
    
    - name: Notifier l'√©chec
      if: failure()
      run: |
        echo -e "\e[1;31m‚ùå Le pipeline CI a √©chou√©. Veuillez corriger les probl√®mes et pousser √† nouveau.\e[0m"
        exit 1