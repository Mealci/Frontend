name: CI

on:
  push:
    branches:
      - '*'

jobs:
  ci:
    name: Flutter CI
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.24.2'
        channel: 'stable'
    
    - name: Get dependencies
      run: |
        echo -e "\e[1;34mğŸ” Getting dependencies...\e[0m"
        flutter pub get
        echo -e "\e[1;32mâœ… Dependencies retrieved successfully!\e[0m"
    
    - name: Format code
      run: |
        echo -e "\e[1;34mğŸ–Œï¸ Formatting code...\e[0m"
        dart format --set-exit-if-changed .
        echo -e "\e[1;32mâœ… Code formatted successfully!\e[0m"
    
    - name: Run tests
      run: |
        echo -e "\e[1;34mğŸ§ª Running tests...\e[0m"
        echo "placeholder flutter test"
        echo -e "\e[1;32mâœ… Tests completed successfully!\e[0m"
    
    - name: Check quality gate
      if: success()
      run: |
        echo -e "\e[1;32mâœ… Quality gate passed\e[0m"
    
    - name: Notify failure
      if: failure()
      run: |
        echo -e "\e[1;31mâŒ CI pipeline failed. Please fix the issues and push again.\e[0m"
        exit 1